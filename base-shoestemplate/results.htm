{# suredone default product list layout #}
{% if get_reqs('view') %}
	{% set group = get_reqs('view') %}
{% endif %}

{% set group_defaults = ['default', 'orders_default', 'page_index', 'grid', 'stock', 'list'] %}
{% set group_settings = sd_option('results_group_default') ? json_decode(sd_option('results_group_default'), true) : {'group': 'default'} %}

{% if not results %}
	{% set results = output.results %}
{% endif %}

{% if not group %}
	{% set group = output.group %}
	{% if not group %}
		{% set group = group_settings['group'] %}
		{% if not group %}
			{% set group = 'default' %}
		{% endif %}
	{% endif %}
{% endif %}

{% if (not (group in group_defaults) and group and (group in (sd_option('results_group_options')|split('*')))) %}
    {% include 'groups.htm' %}
{% elseif (group == 'orders_default') %}

    {% if results %}
        {% set url = output.accounts_uri %}
        {% set sort_string = get_accounts_sort() %}

	    {% if (sort_string == sd_option('site_accounts_sort_default')) %}
	        {% set sort_query_string = '' %}
	    {% else %}
		    {% set sort_query_string = 'sort=' ~ sort_string ~ '&' %}
	    {% endif %}

	    {% if (not preg_match('/_$/', sort_string)) %}
            {% set sort = sort_string %}
            {% set sort_direction = 'ASC' %}
        {% else %}
            {% set sort = sort_string|slice(0, -1) %}
            {% set sort_direction = 'DESC' %}
        {% endif %}

		{# setup output.sorting #}
		{% set sortlinks = [] %}
		{% for link in output.accounts_sorting %}
			{% set sortlinks = sortlinks|merge({ link : '<a href="' ~  url ~ '?sort=' ~ link ~ '" onclick="return sdAjaxCall(\'sort=' ~ link ~ '\')">' ~ output.accounts_sorting_labels[link] ~ '</a>' }) %}
		{% endfor %}
            
        {% if (sort_direction == 'ASC') %}
            {% set sortlinks = sortlinks|merge({ sort : '<a class="sort-asc" href="' ~ url ~ '?sort=' ~ sort ~ '_" onclick="return sdAjaxCall(\'sort=' ~ sort ~ '_\')">' ~ output.accounts_sorting_labels[sort] ~ '</a>'}) %}
        {% else %}
	        {% set sortlinks = sortlinks|merge({ sort : '<a class="sort-desc" href="' ~ url ~ '?sort=' ~ sort ~ '" onclick="return sdAjaxCall(\'sort=' ~ sort ~ '\')">' ~ output.accounts_sorting_labels[sort] ~ '</a>'}) %}
        {% endif %}

		{# setup head #}
		<table rules="all" cellspacing="0" cellpadding="0" id="sd-acctOrders">
			<col width="100"/>
			<col width="150"/>
			<col width="150"/>
			<col width="100"/>
			<col width="50"/>
			<col width="150"/>
			<col width="100"/>
			<thead>
				<tr>
					<td colspan="7" id="sd-acctOrdersTitle">{{ sd_siteinfo('business', false) }} Orders</td>
				</tr>
				<tr id="results-head">
					<td>{{ sortlinks['date'] }}</td>
					<td>{{ sortlinks['order'] }}</td>
					<td>{{ sortlinks['titles'] }}</td>
					<td>{{ sortlinks['items'] }}</td>
					<td>QTYS</td>
					<td>{{ sortlinks['shiptracking'] }}</td>
					<td>{{ sortlinks['total'] }}</td>
				</tr>
			</thead>
	
		{# get data and setup thumbs #}
	        <tbody>
	    {% for key, row in results %}
		    {% if (key == 'all' or key == 'time') %}
			    {# continue #}
			   {% else %}
		
			    {% set page_total = page_total + row['total'] %}
			    {% set media = sd_parsemedia(row['media']) %}
		
			    {% if (is_image(media[0])) %}
				    {% set image_url = sd_getmediathumb(media[0]) %}
				    {% set alt_text = row['title'] %}
			    {% else %}
				    {% set image_url = sd_securemedia(output.icons['no_thumb']) %}
				    {% set alt_text = '' %}
			    {% endif %}
		
			    {% if (rownum != 1) %}
				    {% set rowclass = 'sd-otd' %}
				    {% set rownum = 1 %}
			    {% else %}
				    {% set rowclass = 'sd-otd-x' %}
				    {% set rownum = 0 %}
			    {% endif %}
		
			    {% if not ('|' in row['items']) %}
			        {% set order_items = row['items']|replace({'*': '<br />'})%}
			    {% else %}
		
				    {% if not ('*' in row['items']) %}
				        {% set order_items = preg_replace('/^(.+\|)?(.+)$/', '$2', row['items']) %}
				    {% else %}
					    {% set all_items = preg_replace('/^(.+\|)?(.+)$/', '$2', row['items']|split('*')) %}
					    {% set order_items = all_items|join('<br />') %}
				    {% endif %}
			    {% endif %}

			    <tr class="{{ rowclass }}">
				    <td class="acct-order-time">{{ row['date'] }}</td>
				    <td class="acct-order-number">
					    <a href="{{ url }}?do=invoice&order={{ row['order'] }}" target="_blank">{{ row['order'] }}</a>
					    <span>
						    <em>
							    <a href="{{ output.helpform_uri }}?do=support&order={{ row['order'] }}&items={{ row['items']|replace({'*': ','}) }}">Support</a>
						    </em> |
						    <em>
							    <a href="{{ output.helpform_uri }}?do=returns&order={{ row['order'] }}&items={{ row['items']|replace({'*': ','}) }}">Return</a>
						    </em>
					    </span>
				    </td>
				    <td class="acct-order-titles">{{ row['titles']|replace({'*': '<br />'}) }}</td>
				    <td class="acct-order-items">{{ order_items }}</td>
				    <td class="acct-order-qtys">{{ row['qtys']|replace({'*': '<br />'}) }}</td>
				    <td class="acct-order-tracking">
					    {{ sd_order_tracking(row) }}
				    </td>
				    <td class="acct-order-totals">{{ sd_currency(false) ~ row['total'] }}</td>
			    </tr>
		    {% endif %}
		{% endfor %}
			</tbody>

		{# setup page nav #}
		{% set pages = sd_page_numbers('array', results['all'], sd_option('site_accounts_orders_limit')) %}
	
		{% if (pages['total_pages'] > 1) %}
			<tfoot>
				<tr class="results-pages">
					<td>{{ pages['page_of'] }}<br/>{{ pages['total_items'] }}</td>
					<td>{{ pages['page_goto'] }}</td>
					<td colspan="3">{{ pages['page_nums_plus'] }}</td>
					<td colspan="2">Total: {{ sd_currency(false) ~ page_total }}</td>
				</tr>
			</tfoot>
		{% else %}
			<tfoot>
				<tr class="results-pages">
					<td colspan="6"></td>
					<td>Total {{  sd_currency(false) ~ page_total }}</td>
				</tr>
			</tfoot>
		{% endif %}
		</table>
	{% endif %}

{% elseif (group == 'page_index') %}

    {% if results %}
        {% set url = sd_seturl() %}

	    {% set search_query = get_search_query() %}
	    {% if search_query %}
	        {% set search_query_string = 'q=' ~ search_query ~ '&' %}
	    {% else %}
		    {% set search_query_string = '' %}
	    {% endif %}

		{% set sort_string = get_sort() %}
		{% if (sort_string == sd_option('site_sort_default')) %}
			{% set sort_query_string = '' %}
		{% else %}
			{% set sort_query_string = 'sort=' ~ sort_string ~ '&' %}
		{% endif %}

        {% if (not preg_match('/_$/', sort_string)) %}
            {% set sort = sort_string %}
            {% set sort_direction = 'ASC' %}
        {% else %}
	        {% set sort = sort_string|slice(0, -1) %}
	        {% set sort_direction = 'DESC' %}
        {% endif %}

		{# setup output.sorting #}
		{% set sortlinks = [] %}

		{% for link in output.sorting %}
			{% set sortlinks = sortlinks|merge({ link : ('<a href="' ~ url ~ '?' ~ search_query_string ~ 'sort=' ~ link ~ '" onclick="return sdAjaxCall(\'' ~ search_query_string ~ 'sort=' ~ link ~ '\')">' ~ output.sorting_labels[link] ~ '</a>') }) %}
		{% endfor %}

        {% if (sort_direction == 'ASC') %}
            {% set sortlinks = sortlinks|merge({ sort : ('<a class="sort-asc" href="' ~ url ~ '?' ~ search_query_string ~ 'sort=' ~ sort ~ '_" onclick="return sdAjaxCall(\'' ~ search_query_string ~ 'sort=' ~ sort ~ '_\')">' ~ output.sorting_labels[sort] ~ '</a>')}) %}
        {% else %}
            {% set sortlinks = sortlinks|merge({ sort : '<a class="sort-desc" href="' ~ url ~ '?' ~ search_query_string ~ 'sort=' ~ sort ~ '" onclick="return sdAjaxCall(\'' ~ search_query_string ~ 'sort=' ~ sort ~ '\')">' ~ output.sorting_labels[sort] ~ '</a>'}) %}
        {% endif %}

	<div id="sd-releases">
		{# get data #}
		{% for key, row in results %}
			{% if (key == 'all' or key == 'time') %}
				{# continue #}
			{% else %}
			<p class="release-item">
				<strong><a href="{{ sd_seturl([row['uri'], row['name']], 'page') }}">{{ row['title'] }}</a></strong>
				<span class="description">{{ row['description'] }}</span>
			</p>
			{% endif %}
		{% endfor %}

	    <table rules="none">
		    <col/>
		    <col/>
		    <col/>
		    <col/>
		{# setup page nav #}
		{% set pages = sd_page_numbers('array') %}

		{% if (pages['total_pages'] > 1) %}
			<tbody>
				<tr class="results-pages">
					<td>{{ pages['page_of'] }}</td>
					<td>{{ pages['page_goto'] }}</td>
					<td>{{ pages['page_nums_plus'] }}</td>
					<td>{{ pages['total_items'] }}</td>
				</tr>
			</tbody>
		{% else %}
			<tbody>
				<tr class="results-pages">
					<td colspan="4"></td>
					<td>{{ pages['total_items'] }}</td>
				</tr>
			</tbody>
		{% endif %}
		</table>
	</div>
	{% endif %}

{% elseif (group == 'stock') %}

    {# original stock/condition production layout #}
    {% if (output.items_html and not sd_is_get and group == group_settings['group']) %}
        {{ output.items_html }}
    {% else %}
		{# stocked layout #}
		{% if results %}
			{% set url = sd_seturl() %}

			{% set search_query = get_search_query() %}
			{% if search_query %}
				{% set search_query_string = 'q=' ~ search_query ~ '&' %}
			{% else %}
				{% set search_query_string = '' %}
			{% endif %}

			{% set sort_string = get_sort() %}
			{% if (sort_string == sd_option('site_sort_default')) %}
				{% set sort_query_string = '' %}
			{% else %}
				{% set sort_query_string = 'sort=' ~ sort_string ~ '&' %}
			{% endif %}

		    {% if (not preg_match('/_$/', sort_string)) %}
			    {% set sort = sort_string %}
			    {% set sort_direction = 'ASC' %}
		    {% else %}
		        {% set sort = sort_string|slice(0, -1) %}
		        {% set sort_direction = 'DESC' %}
		    {% endif %}

			{# setup output.sorting #}
			{% set sortlinks = [] %}

			{% for link in output.sorting %}
				{% set sortlinks = sortlinks|merge({ link : '<a href="' ~ url ~ '?' ~ search_query_string ~ 'sort=' ~ link ~ '" onclick="return sdAjaxCall(\'' ~ search_query_string ~ 'sort=' ~ link ~ '\')">' ~ output.sorting_labels[link] ~ '</a>'}) %}
			{% endfor %}

	        {% if (sort_direction == 'ASC') %}
	            {% set sortlinks = sortlinks|merge({ sort : '<a class="sort-asc" href="' ~ url ~ '?' ~ search_query_string ~ 'sort=' ~ sort ~ '_" onclick="return sdAjaxCall(\'' ~ search_query_string ~ 'sort=' ~ sort ~ '_\')">' ~ output.sorting_labels[sort] ~ '</a>'}) %}
	        {% else %}
		        {% set sortlinks = sortlinks|merge({ sort : '<a class="sort-desc" href="' ~ url ~ '?' ~ search_query_string ~ 'sort=' ~ sort ~ '" onclick="return sdAjaxCall(\'' ~ search_query_string ~ 'sort=' ~ sort ~ '\')">' ~ output.sorting_labels[sort] ~ '</a>'}) %}
	        {% endif %}

			{# offer sets #}
			{% set offerconditions = ['new', 'used', 'refurbished'] %}
			{% set offercurrency = sd_option('site_currency') %}

			{# setup head #}
		<table rules="all" cellspacing="0" cellpadding="0" id="results-content" itemscope
		       itemtype="http://data-vocabulary.org/Product">
			<col width="50"/>
			<col width="50"/>
			<col width="50"/>
			<col width="50"/>
			<col width="400"/>
			<col width="200"/>
			<thead>
			<tr id="results-head">
				<td>{{ sortlinks['stock'] }}</td>
				<td>{{ sortlinks['condition'] }}</td>
				<td>{{ sortlinks['sku'] }}</td>
				<td>{{ sortlinks['price'] }}</td>
				<td>{{ sortlinks['title'] }}</td>
				<td>Pic</td>
			</tr>
			</thead>
		    {# get data and setup thumbs #}
		    <tbody>
		    {% for key, row in results %}

			    {% if (key == 'all' or key == 'time') %}
				    {# continue #}
			    {% else %}

				    {% if row['guid'] %}
					    {% set sku = row['guid'] %}
				    {% else %}
					    {% set sku = row['sku'] %}
				    {% endif %}

				    {% set media = sd_parsemedia(row['media']) %}

				    {% if (is_image(media[0])) %}
					    {% set image_url = sd_getmediathumb(media[0]) %}

					    {% if media[1] %}
						    {% set alt_text = media[1] %}
					    {% else %}
						    {% set alt_text = row['title'] %}
					    {% endif %}

					    {% if (sd_option('image_thumb_titles') == 'on') %}
						    {% set alt_text = alt_text ~ '" title="' ~ alt_text %}
					    {% endif %}

				    {% else %}
					    {% set image_url = output.icons['no_thumb'] %}
					    {% set alt_text = '' %}
				    {% endif %}

				    {% if (rownum != 1) %}
					    {% set rowclass = 'row-data' %}
					    {% set rownum = 1 %}
				    {% else %}
					    {% set rowclass = 'row-data-x' %}
					    {% set rownum = 0 %}
				    {% endif %}

				    {% set itemurl = sd_seturl(row['uri'], 'item') %}
				    {% set discountpricecss = row['discountprice'] > 0 ? ' td-discount-price' : '' %}

				    {# offer details #}
				    <tr>
					    <td class="td-price{{ discountpricecss }}" itemprop="offerDetails" itemscope itemtype="http://data-vocabulary.org/Offer">
						    <meta itemprop="currency" content="{{ offercurrency }}"/>
						    <meta itemprop="price" content="{{ sd_price(false, false, false, row) }}"/>
						    {{ sd_price(false, true, true, row) }}
					    </td>
					    <td class="td-title">
						    <a href="{{ itemurl }}">{{ row['title'] }}</a>
						    {# need info #}
						    {#
						    {{ this.cart_details_html(row, key) }}
						    #}
						    {{ sd_content('cart_details') }}
					    </td>
					    <td>
						    <a href="{{ itemurl }}"><img alt="{{ alt_text }}" class="row-data-img" src="{{ image_url }}"/></a>
						    <meta itemprop="name" content="{{ row['title'] }}" />
						    <meta itemprop="offerURL" content="{{ sd_seturl(row['uri'], 'item') }}" />
						    {% if row['brand'] %}
							    <meta itemprop="brand" content="{{ row['brand'] }}" />
						    {% endif %}
					    </td>
				    </tr>
			    {% endif %}
		    {% endfor %}
		    </tbody>

			{# setup page nav #}
			{% set pages = sd_page_numbers('array') %}

			{% if (pages['total_pages'] > 1) %}
			<tfoot>
				<tr class="results-pages">
					<td colspan="2">{{ pages['page_of'] }}</td>
					<td colspan="2">{{ pages['page_goto'] }}</td>
					<td>{{ pages['page_nums_plus'] }}</td>
					<td>{{ pages['total_items'] }}</td>
				</tr>
			</tfoot>
			{% else %}
			<tfoot>
				<tr class="results-pages">
					<td colspan="5"></td>
					<td>{{ pages['total_items'] }}</td>
				</tr>
			</tfoot>
			{% endif %}
		</table>
		{% elseif (sd_is_search and (not get_search_query())) %}
			{# html = '' #}
		{% else %}
			{# empty results #}
		    <table rules="all" cellspacing="0" cellpadding="0" id="results-empty">
			    <col width="800"/>
			    <tr>
				    <td>{{ sd_option('results_empty_default') }}</td>
			    </tr>
		    </table>
	    {% endif %}
	{% endif %}

{% elseif (group == 'grid') %}

	{% if (not output.items_html and not sd_is_get and group == group_settings['group']) %}
		{{ output.items_html }}
	{% else %}
		{# product grid #}
		{% if results %}
			{% spaceless %}
			{% set url = sd_seturl() %}

			{% set search_query = get_search_query() %}
			{% if search_query %}
				{% set search_query_string = 'q=' ~ search_query ~ '&' %}
			{% else %}
				{% set search_query_string = '' %}
			{% endif %}

			{% set sort_string = get_sort() %}
            {% if sort_string %}
                {% set sort_query_string = 'sort=' ~ sort_string ~ '&' %}
            {% else %}
                {% set sort_query_string = '' %}
            {% endif %}

            {% if get_reqs('page') %}
                {% set page_query_string = 'page=' ~ get_reqs('page') ~ '&' %}
            {% else %}
                {% set page_query_string = '' %}
            {% endif %}

            {% if search_query_string or sort_query_string  %}
                {% set full_query_string = search_query_string ~ sort_query_string ~ page_query_string %}
                {% set full_url = url ~ '?' ~ full_query_string %}
            {% else %}
                {% set full_query_string = '' %}
                {% set full_url = url %}
            {% endif %}

			{# setup output.sorting #}
			{% set sortlinks = [] %}
			{% set sortdefaults = sd_option('site_sort_defaults')|split('*') %}
			{% set sorticonasc = sd_option('site_sort_icon_asc') %}
			{% set sorticondesc = sd_option('site_sort_icon_desc') %}

			{# setup grid col count #}
			{% set colmaxset = sd_option('product_grid_columns') %}
			{% set colmax = colmaxset ? colmaxset : 5 %}

			{% set colmax = 4 %}
			{% set colwid = 800 / colmax %}

			{% for link in output.sorting %}
				{% if link in sortdefaults %}
					{% if (sort_string == link) %}
						{% set sort_selected = " selected" %}
					{% elseif (sort_string == (link ~ '_')) %}
						{% set sort_selected_d = " selected" %}
					{% else %}
						{% set sort_selected = '' %}
						{% set sort_selected_d = '' %}
					{% endif %}

					{% set sortlinks = sortlinks|merge(['<option value="' ~ link ~ '"' ~ sort_selected ~ '>' ~ output.sorting_labels[link] ~ ' ' ~ sorticonasc ~ '</option>']) %}
					{% set sortlinks = sortlinks|merge(['<option value="' ~ link ~ '_"' ~ sort_selected_d ~ '>' ~ output.sorting_labels[link] ~ ' ' ~ sorticondesc ~ '</option>']) %}
				{% endif %}
			{% endfor %}

			{% set sortoptions = '<select name="sort" onchange="sdAjaxForm(this.form)">' ~ (sortlinks|join('')) ~ '</select>' %}
			{% set grid_sort = '<form action="'~ url ~ '" method="get" id="sort-page-form"  name="sort_page_form">' ~ sortoptions %}

			{% if (search_query) %}
				{% set grid_sort = grid_sort ~ '<input type="hidden" name="q" value="' ~search_query ~ '" />' %}
			{% endif %}

			{% if (group != group_settings['group']) %}
				{% set grid_sort = grid_sort ~ '<input type="hidden" name="view" value="' ~ group ~ '" />' %}
			{% endif %}
			{% set grid_sort = grid_sort ~ '</form>' %}
			{# offer sets #}
			{% set offerconditions = ['new', 'used', 'refurbished'] %}
			{% set offercurrency = sd_option('site_currency') %}
			{% endspaceless %}
            <div class="col-md-12">
                <div class="clearfix" id="collection">
                    <div class="collection-toolbar">
                <!-- Tags Filter -->
                            <div class="tags-filter">
                                <button id="showTagsFilter">Filter</button>
                            </div>
                            <!-- Showing -->
                            <div class="showing-number">
                                {% set pages = sd_page_numbers('array') %}
                                {% if (pages['total_pages'] > 1) %}
                                    Showing {{ pages['results_of'] }} results
                                {% else %}
                                    {{ pages['total_items'] }}
                                {% endif %}
                            </div>
                            <div class="list-inline text-right">
                                <!-- Sort by -->
                                <div class="sortBy">
                                    <div id="sortButtonWarper" class="dropdown-toggle" data-toggle="dropdown">
                                    {{ grid_sort }}
                                    </div>
                                </div>
                                <!-- Number product per page -->

                    <!-- View as -->

                                <div class="grid_list">
                                    <ul class="list-inline option-set hidden-xs" data-option-key="layoutMode">
                                        <li data-option-value="fitRows" id="goGrid" class="Grid" data-toggle="tooltip" data-placement="top" title="Grid">
                                            <i class="fa fa fa-th"></i>
                                        </li>
                                        <li id="goList">
                                            <a href="{{ full_url }}view=list" id="goList" onclick="return sdAjaxCall('{{ full_query_string }}view=list')" title="List" class="list">
                                            <i class="fa fa-th-list"></i>
                                        </a>
                                        </li>

                                    </ul>
                                </div>
                            </div>
                     </div>
                </div>
            </div>
			{# setup table #}
			{# get data and setup thumbs #}

			{% set colnum = 1 %}
			{% set colnext = colmax + 1 %}
			<div class="col-md-12">
			     <div id="sandBox" class="products" style="position: relative; ">
			{% for key, row in results %}
				{% if (key == 'all' or key == 'time') %}
					{# continue #}
				{% else %}
					{% spaceless %}
					{% if row['guid'] %}
						{% set sku = row['guid'] %}
					{% else %}
						{% set sku = row['sku'] %}
					{% endif %}

					{% set media = sd_parsemedia(row['media']) %}

					{% if (is_image(media[0])) %}
						{% set image_url = sd_getmediathumb(media[0]) %}

						{% if media[1] %}
							{% set alt_text = media[1]|escape %}
						{% else %}
							{% set alt_text = row['title']|escape %}
						{% endif %}

						{% if (sd_option('image_thumb_titles') == 'on') %}
							{#
							{% set alt_text = alt_text ~ '" title="' ~ alt_text %}
							#}
						{% endif %}
					{% else %}
						{% set image_url = output.icons['no_thumb'] %}
						{% set alt_text = '' %}
					{% endif %}

					{% set discountpricecss = row['discountprice'] > 0 ? ' td-discount-price' : '' %}

					{% if (colnum == 1) %}
						{% if (rownum != 1) %}
							{% set rowclass = 'first' %}
							{% set rownum = 1 %}
						{% else %}
							{% set rowclass = ' ' %}
							{% set rownum = 0 %}
						{% endif %}
                                {% endif %}
                                {% endspaceless %}
                                <div class="element {{ rowclass }} no_full_width" data-alpha="Donec condimentum fer" data-price="20000">
                                    <div class="product-item-wapper" itemscope itemtype="http://schema.org/Product">
                                        <div class="row-container list-unstyled clearfix">
                                            <div class="row-left">
                                                <a href="{{ sd_seturl(row['uri'], 'item') }}" title="{{ alt_text }}" class="hoverBorder container_item">
                                                    <div class="hoverBorderWrapper">
                                                        <img src="{{ image_url }}" class="not-rotation img-responsive front" alt="{{ alt_text }}" />
                                                        <div class="mask"></div>
                                                    </div>
                                                </a>
                                                <div class="hover-mask">
                                                    <div class="group-mask">
                                                        <div class="inner-mask">
                                                            <div class="effect-ajax-cart">
                                                                <input type="hidden" name="quantity" value="1" />
                                                                <button class="btn btn-1 select-option" type="button" onclick="window.location='{{ sd_seturl(row['uri'], 'item') }}';"><i class="fa fa-bars"></i>View Details</button>
                                                            </div>
                                                        </div><!--inner-mask-->
                                                    </div><!--Group mask-->
                                                </div>
                                            </div>
                                            <div class="row-right animMix" style="padding-left: 10px; padding-right: 10px;">
                                                <a class="title-5" href="{{ sd_seturl(row['uri'], 'item') }}">{{ row['title'] }}</a>
                                                <div class="product-price">
                                                    <span class="price" itemprop="offers" itemscope itemtype="http://schema.org/Offer">
														{{ sd_price(false, true, true, row) }}
														<meta itemprop="priceCurrency" content="{{ offercurrency }}" />
														<meta itemprop="price" content="{{ sd_price(false, false, false, row) }}"/>
														<meta itemprop="availability" content="InStock" />
														{% if (row['total_stock']>0) %}
															<meta itemprop="inventoryLevel" content="{{ row['total_stock'] }}" />
														{% endif %}
														{% if (row['condition'] and offerconditions[row['condition']|lower] is defined ) %}
															<meta itemprop="itemCondition" itemtype="http://schema.org/OfferItemCondition" content="{{ offerconditions[row['condition']|lower] }}" />
														{% endif %}
														<meta itemprop="url" content="{{ sd_seturl(row['uri'], 'item') }}" />
													</span>
                                                </div>
                                                <div class="list-mode-description">{{ sd_content('long_description') }}</div>
                                                {#<div class="effect-ajax-cart">
                                                    <input type="hidden" name="quantity" value="1" />
                                                    <button class="btn btn-1 select-option" type="button" onclick="window.location='{{ sd_seturl(row['uri'], 'item') }}';"><i class="fa fa-bars"></i>View Details</button>
                                                </div>#}
                                            </div>
										{# offer details #}
										<meta itemprop="name" content="{{ row['title']|escape('html') }}" />
										{% if row['brand'] %}
											<meta itemprop="brand" content="{{ row['brand']|escape('html') }}" />
										{% endif %}
										{% if (is_image(media[0])) %}
											<meta itemprop="image" content="{{ media[0] }}" />
										{% endif %}
										{% if row['weight'] > 0 %}
											<meta itemprop="weight" content="{{ row['weight'] }}" />
										{% endif %}
										{% if row['color'] %}
											<meta itemprop="color" content="{{ row['color'] }}" />
										{% endif %}
										{% if row['upc']|length == 12 %}
											<meta itemprop="gtin12" content="{{ row['upc'] }}" />
										{% endif %}
										{% if (row['ean'] is defined and row['ean']) or row['upc']|length == 13 %}
											{% set rowean = row['ean'] is defined and row['ean'] ? row['ean'] : row['upc'] %}
											<meta itemprop="gtin13" content="{{ rowean }}" />
										{% endif %}
										{% if (row['gtin'] is defined and row['gtin']) %}
											<meta itemprop="gtin14" content="{{ row['gtin'] }}" />
										{% endif %}
										{% if (row['mpn'] is defined and row['mpn']) %}
											<meta itemprop="mpn" content="{{ row['mpn']|escape('html') }}" />
										{% endif %}
										{% if (row['manufacturer'] is defined and row['manufacturer']) %}
											<meta itemprop="manufacturer" content="{{ row['manufacturer']|escape('html') }}" />
										{% endif %}
										{% if (row['model'] is defined and row['model']) %}
											<meta itemprop="model" content="{{ row['model']|escape('html') }}" />
										{% endif %}
										<meta itemprop="sku" content="{{ row['guid']|escape('html') }}" />
					          </div>
					     </div>
					</div>
					{% if (colnum == colmax) %}

					{% endif %}

					{% set colnum= colnum + 1 %}

					{% if (colnum == colnext) %}
						{% set colnum = 1 %}
					{% endif %}
				{% endif %}
			{% endfor %}

			{% if (colnum > 1) %}

			{% endif %}
                 </div>
            </div>
			{# setup page nav, head, and foot #}
            <div class="col-md-12">
                <div class="pagination">
					<div class="pager">
						{# setup page nav, head, and foot #}
						{% set pages = sd_page_numbers('array') %}
						{% if (pages['total_pages'] > 1) %}
							<div class="pages">
								<strong>Page:</strong>
								{{ pages['page_nums_plus'] }}
							</div>
						{% else %}
							<div class="limiter hidden-xs hidden-sm">{{ pages['total_items'] }}</div>
							<div class="pages"> </div>
						{% endif %}
					</div>
				</div>
			</div>
		{% elseif (sd_is_search and (not get_search_query())) %}
		{# html = '' #}
		{% else %}
		{# empty results #}
		<table rules="all" cellspacing="0" cellpadding="0" id="results-empty">
			<col width="800"/>
			<tr>
				<td>{{ sd_option('results_empty_default') }}</td>
			</tr>
		</table>
	    {% endif %}
	{% endif %}

{% elseif (group == 'list') %}

	{% if (not output.items_html and not sd_is_get and group == group_settings['group']) %}
		{{ output.items_html }}
	{% else %}
		{# product list #}
		{% if results %}
			{% spaceless %}
			{% set url = sd_seturl() %}

			{% set search_query = get_search_query() %}
			{% if search_query %}
				{% set search_query_string = 'q=' ~ search_query ~ '&' %}
			{% else %}
				{% set search_query_string = '' %}
			{% endif %}

			{% set sort_string = get_sort() %}
            {% if sort_string %}
                {% set sort_query_string = 'sort=' ~ sort_string ~ '&' %}
            {% else %}
                {% set sort_query_string = '' %}
            {% endif %}

            {% if get_reqs('page') %}
                {% set page_query_string = 'page=' ~ get_reqs('page') ~ '&' %}
            {% else %}
                {% set page_query_string = '' %}
            {% endif %}

            {% if search_query_string or sort_query_string  %}
                {% set full_query_string = search_query_string ~ sort_query_string ~ page_query_string %}
                {% set full_url = url ~ '?' ~ full_query_string %}
            {% else %}
                {% set full_query_string = '' %}
                {% set full_url = url %}
            {% endif %}

			{# setup output.sorting #}
			{% set sortlinks = [] %}
			{% set sortdefaults = sd_option('site_sort_defaults')|split('*') %}
			{% set sorticonasc = sd_option('site_sort_icon_asc') %}
			{% set sorticondesc = sd_option('site_sort_icon_desc') %}

			{% for link in output.sorting %}
				{% if link in sortdefaults %}
					{% if (sort_string == link) %}
						{% set sort_selected = " selected" %}
					{% elseif (sort_string == (link ~ '_')) %}
						{% set sort_selected_d = " selected" %}
					{% else %}
						{% set sort_selected = '' %}
						{% set sort_selected_d = '' %}
					{% endif %}

					{% set sortlinks = sortlinks|merge(['<option value="' ~ link ~ '"' ~ sort_selected ~ '>' ~ output.sorting_labels[link] ~ ' ' ~ sorticonasc ~ '</option>']) %}
					{% set sortlinks = sortlinks|merge(['<option value="' ~ link ~ '_"' ~ sort_selected_d ~ '>' ~ output.sorting_labels[link] ~ ' ' ~ sorticondesc ~ '</option>']) %}
				{% endif %}
			{% endfor %}

			{% set sortoptions = '<select name="sort" onchange="sdAjaxForm(this.form)">' ~ (sortlinks|join('')) ~ '</select>' %}
			{% set grid_sort = '<form action="'~ url ~ '" method="get" id="sort-page-form" name="sort_page_form">' ~ sortoptions %}

			{% if (search_query) %}
				{% set grid_sort = grid_sort ~ '<input type="hidden" name="q" value="' ~search_query ~ '" />' %}
			{% endif %}

			{% if (group != group_settings['group']) %}
				{% set grid_sort = grid_sort ~ '<input type="hidden" name="view" value="' ~ group ~ '" />' %}
			{% endif %}
			{% set grid_sort = grid_sort ~ '</form>' %}
			{# offer sets #}
			{% set offerconditions = ['new', 'used', 'refurbished'] %}
			{% set offercurrency = sd_option('site_currency') %}
			{% endspaceless %}
            <div class="col-md-12">
                <div class="clearfix" id="collection">
                    <div class="collection-toolbar">
                        <!-- Tags Filter -->
                        <div class="tags-filter">
                            <button id="showTagsFilter">Filter</button>
                        </div>
                        <!-- Showing -->
                        <div class="showing-number">
                            {% set pages = sd_page_numbers('array') %}
                            {% if (pages['total_pages'] > 1) %}
                                Showing {{ pages['results_of'] }} results
                            {% else %}
                                {{ pages['total_items'] }}
                            {% endif %}
                        </div>
                        <div class="list-inline text-right">
                            <!-- Sort by -->
                            <div class="sortBy">
                                {{ grid_sort }}
                            </div>
                            <!-- Number product per page -->

                            <!-- View as -->
                            <div class="grid_list">
                                <ul class="list-inline option-set hidden-xs" data-option-key="layoutMode">
                                    <li id="goGrid"><a href="{{ full_url }}view=grid" onclick="return sdAjaxCall('{{ full_query_string }}view=grid')" title="Grid" class="grid">
                                        <i class="fa fa fa-th"></i>
                                    </a></li>
                                    <li data-option-value="straightDown" id="goList" class="goAction " data-toggle="tooltip" data-placement="top" title="List">
                                        <i class="fa fa-th-list"></i>
                                    </li>

                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div id="sandBox" class="products" style="position: relative;">

                {# setup list #}
                {# get data and setup thumbs #}
                {% for key, row in results %}
                    {% if (key == 'all' or key == 'time') %}
                        {# continue #}
                    {% else %}
                        {% spaceless %}
                        {% if row['guid'] %}
                            {% set sku = row['guid'] %}
                        {% else %}
                            {% set sku = row['sku'] %}
                        {% endif %}

                        {% set media = sd_parsemedia(row['media']) %}

                        {% if (is_image(media[0])) %}
                            {% set image_url = sd_getmediathumb(media[0]) %}

                            {% if media[1] %}
                                {% set alt_text = media[1]|escape %}
                            {% else %}
                                {% set alt_text = row['title']|escape %}
                            {% endif %}

                            {% if (sd_option('image_thumb_titles') == 'on') %}
                                {#
                                {% set alt_text = alt_text ~ '" title="' ~ alt_text %}
                                #}
                            {% endif %}
                        {% else %}
                            {% set image_url = output.icons['no_thumb'] %}
                            {% set alt_text = '' %}
                        {% endif %}

                        {% set discountpricecss = row['discountprice'] > 0 ? ' td-discount-price' : '' %}
                        {% endspaceless %}

                        <div class="element {{ rowclass }} full_width jemiz-animated" data-alpha="Donec condimentum fer" data-price="20000">
                            <div class="product-item-wapper" itemscope itemtype="http://schema.org/Product">
                                <div class="row-container list-unstyled clearfix">
                                    <div class="row-left col-md-4">
                                        <a href="{{ sd_seturl(row['uri'], 'item') }}" title="{{ alt_text }}" class="hoverBorder container_item">
                                            <div class="hoverBorderWrapper">
                                                <img src="{{ image_url }}" class="not-rotation img-responsive front" alt="{{ alt_text }}" />
                                                <div class="mask"></div>
                                            </div>
                                        </a>
                                        <div class="hover-mask">
                                            <div class="group-mask">
                                                <div class="inner-mask">
                                                    <div class="effect-ajax-cart">
                                                        <input type="hidden" name="quantity" value="1" />
                                                        <button class="btn btn-1 select-option" type="button" onclick="window.location='{{ sd_seturl(row['uri'], 'item') }}';"><i class="fa fa-bars"></i>View Details</button>
                                                    </div>


                                            </div><!--inner-mask-->
                                        </div><!--Group mask-->
                                    </div>
                                </div>
                                    <div class="row-right animMix col-md-8 " style="padding-left: 10px; padding-right: 10px;">
                                        <a class="title-5" href="{{ sd_seturl(row['uri'], 'item') }}">{{ row['title'] }}</a>
                                        <div class="product-price">
                                            <span class="price" itemprop="offers" itemscope itemtype="http://schema.org/Offer">
	                                            {{ sd_price(false, true, true, row) }}
												<meta itemprop="priceCurrency" content="{{ offercurrency }}" />
												<meta itemprop="price" content="{{ sd_price(false, false, false, row) }}"/>
												<meta itemprop="availability" content="InStock" />
												{% if (row['total_stock']>0) %}
													<meta itemprop="inventoryLevel" content="{{ row['total_stock'] }}" />
												{% endif %}
												{% if (row['condition'] and offerconditions[row['condition']|lower] is defined ) %}
													<meta itemprop="itemCondition" itemtype="http://schema.org/OfferItemCondition" content="{{ offerconditions[row['condition']|lower] }}" />
												{% endif %}
												<meta itemprop="url" content="{{ sd_seturl(row['uri'], 'item') }}" />
                                            </span>
                                        </div>
                                        <div class="list-mode-description">
                                            {{ sd_content('long_description') }}
                                            </div>
                                        <div class="effect-ajax-cart">
                                            <input type="hidden" name="quantity" value="1" />
                                            <button class="btn btn-1 select-option" type="button" onclick="window.location='{{ sd_seturl(row['uri'], 'item') }}';"><i class="fa fa-bars"></i>View Details</button>
                                        </div>
                                    </div>

                                {# offer details #}
								<meta itemprop="name" content="{{ row['title']|escape('html') }}" />
								{% if row['brand'] %}
									<meta itemprop="brand" content="{{ row['brand']|escape('html') }}" />
								{% endif %}
								{% if (is_image(media[0])) %}
									<meta itemprop="image" content="{{ media[0] }}" />
								{% endif %}
								{% if row['weight'] > 0 %}
									<meta itemprop="weight" content="{{ row['weight'] }}" />
								{% endif %}
								{% if row['color'] %}
									<meta itemprop="color" content="{{ row['color'] }}" />
								{% endif %}
								{% if row['upc']|length == 12 %}
									<meta itemprop="gtin12" content="{{ row['upc'] }}" />
								{% endif %}
								{% if (row['ean'] is defined and row['ean']) or row['upc']|length == 13 %}
									{% set rowean = row['ean'] is defined and row['ean'] ? row['ean'] : row['upc'] %}
									<meta itemprop="gtin13" content="{{ rowean }}" />
								{% endif %}
								{% if (row['gtin'] is defined and row['gtin']) %}
									<meta itemprop="gtin14" content="{{ row['gtin'] }}" />
								{% endif %}
								{% if (row['mpn'] is defined and row['mpn']) %}
									<meta itemprop="mpn" content="{{ row['mpn']|escape('html') }}" />
								{% endif %}
								{% if (row['manufacturer'] is defined and row['manufacturer']) %}
									<meta itemprop="manufacturer" content="{{ row['manufacturer']|escape('html') }}" />
								{% endif %}
								{% if (row['model'] is defined and row['model']) %}
									<meta itemprop="model" content="{{ row['model']|escape('html') }}" />
								{% endif %}
								<meta itemprop="sku" content="{{ row['guid']|escape('html') }}" />
                            </div>
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
                </div>
            </div>

			{# setup page nav, head, and foot #}
            <div class="col-md-12">
                <div class="pagination">
                    <div class="pager">
                        {# setup page nav, head, and foot #}
                        {% set pages = sd_page_numbers('array') %}
                        {% if (pages['total_pages'] > 1) %}
                                <strong>Page:</strong>
                                {{ pages['page_nums_plus'] }}
                            </div>
                        {% else %}
                            <div class="limiter hidden-xs hidden-sm">{{ pages['total_items'] }}</div>
                            <div class="pages"> </div>
                        {% endif %}
                    </div>
                </div>
            </div>
		{% elseif (sd_is_search and (not get_search_query())) %}
		{# html = '' #}
		{% else %}
		{# empty results #}
		<table rules="all" cellspacing="0" cellpadding="0" id="results-empty">
			<col width="800"/>
			<tr>
				<td>{{ sd_option('results_empty_default') }}</td>
			</tr>
		</table>
	    {% endif %}
	{% endif %}
{% elseif (group == 'newest_blogs') %}


	{% if (not output.items_html and not sd_is_get and group == group_settings['group']) %}
		{{ output.items_html }}
	{% else %}
		{# product grid #}
		{% if results %}
			{% spaceless %}
			{% set url = sd_seturl() %}

			{% set search_query = get_search_query() %}
			{% if search_query %}
				{% set search_query_string = 'q=' ~ search_query ~ '&' %}
			{% else %}
				{% set search_query_string = '' %}
			{% endif %}

			{% set sort_string = get_sort() %}
            {% if sort_string %}
                {% set sort_query_string = 'sort=' ~ sort_string ~ '&' %}
            {% else %}
                {% set sort_query_string = '' %}
            {% endif %}

            {% if get_reqs('page') %}
                {% set page_query_string = 'page=' ~ get_reqs('page') ~ '&' %}
            {% else %}
                {% set page_query_string = '' %}
            {% endif %}

            {% if search_query_string or sort_query_string  %}
                {% set full_query_string = search_query_string ~ sort_query_string ~ page_query_string %}
                {% set full_url = url ~ '?' ~ full_query_string %}
            {% else %}
                {% set full_query_string = '' %}
                {% set full_url = url %}
            {% endif %}

			{# setup output.sorting #}
			{% set sortlinks = [] %}
			{% set sortdefaults = sd_option('site_sort_defaults')|split('*') %}
			{% set sorticonasc = sd_option('site_sort_icon_asc') %}
			{% set sorticondesc = sd_option('site_sort_icon_desc') %}

			{% for link in output.sorting %}
				{% if link in sortdefaults %}
					{% if (sort_string == link) %}
						{% set sort_selected = " selected" %}
					{% elseif (sort_string == (link ~ '_')) %}
						{% set sort_selected_d = " selected" %}
					{% else %}
						{% set sort_selected = '' %}
						{% set sort_selected_d = '' %}
					{% endif %}

					{% set sortlinks = sortlinks|merge(['<option value="' ~ link ~ '"' ~ sort_selected ~ '>' ~ output.sorting_labels[link] ~ ' ' ~ sorticonasc ~ '</option>']) %}
					{% set sortlinks = sortlinks|merge(['<option value="' ~ link ~ '_"' ~ sort_selected_d ~ '>' ~ output.sorting_labels[link] ~ ' ' ~ sorticondesc ~ '</option>']) %}
				{% endif %}
			{% endfor %}

			{% set sortoptions = '<select name="sort" onchange="sdAjaxForm(this.form)">' ~ (sortlinks|join('')) ~ '</select>' %}
			{% set grid_sort = '<form action="'~ url ~ '" method="get" id="sort-page-form" name="sort_page_form">' ~ sortoptions %}

			{% if (search_query) %}
				{% set grid_sort = grid_sort ~ '<input type="hidden" name="q" value="' ~search_query ~ '" />' %}
			{% endif %}

			{% if (group != group_settings['group']) %}
				{% set grid_sort = grid_sort ~ '<input type="hidden" name="view" value="' ~ group ~ '" />' %}
			{% endif %}
			{% set grid_sort = grid_sort ~ '</form>' %}
			{# offer sets #}
			{% set offerconditions = ['new', 'used', 'refurbished'] %}
			{% set offercurrency = sd_option('site_currency') %}
			{% endspaceless %}
			{#
			<div class="toolbar">
				<div class="pager">
					<div class="pages">
						{% set pages = sd_page_numbers('array') %}
						
						{% if (pages['total_pages'] > 1) %}
							<strong>Page:</strong>
							{% set pages = pages['page_nums_plus'] %}
						{% endif %}
					</div>
				</div>
			</div>
			#}
			{# setup table #}
			{# get data and setup thumbs #}
			{% set colnum = 1 %}
			{% set colnext = colmax + 1 %}
			{% set lastcolnext = 4 %}
			{% set lastcol = 1 %}

			{% for key, row in results %}
				{% if (key == 'all' or key == 'time') %}
					{# continue #}
				{% else %}
					{% spaceless %}
					{% if row['guid'] %}
						{% set sku = row['guid'] %}
					{% else %}
						{% set sku = row['sku'] %}
					{% endif %}

					{% set media = sd_parsemedia(row['media']) %}

					{% if (is_image(media[0])) %}
						{% set image_url = sd_getmediafull(media[0]) %}

						{% if media[1] %}
							{% set alt_text = media[1]|escape %}
						{% else %}
							{% set alt_text = row['title']|escape %}
						{% endif %}

						{% if (sd_option('image_thumb_titles') == 'on') %}
							{#
							{% set alt_text = alt_text ~ '" title="' ~ alt_text %}
							#}
						{% endif %}
					{% else %}
						{% set image_url = output.icons['no_thumb'] %}
						{% set alt_text = '' %}
					{% endif %}

					{% set discountpricecss = row['discountprice'] > 0 ? ' td-discount-price' : '' %}

					{% if (colnum == 1) %}
						{% if (rownum != 1) %}
							{% set rowclass = 'row-data' %}
							{% set rownum = 1 %}
						{% else %}
							{% set rowclass = 'row-data-x' %}
							{% set rownum = 0 %}
						{% endif %}
                        
					{% endif %}
					{% endspaceless %}
				
					{% if lastcol == 3 %}
						{% set classlastcol = 'last' %}
					{% else %}
						{% set classlastcol = '' %}
					{% endif %}
					    {% if var == 'blog' %}
                    <div class="article blogs-item clearfix">
                        <div class="blog-group">
                            <div class="blog-item-image"><a href="{{ row['url'] }}" title="{{ alt_text }}" class="product-image"><div style="text-align: left;">
                                        <img src="{{ image_url }}" alt="{{ alt_text }}" /></div></a></div>
                            <h4 class="blog-item-title"><a href="{{ row['url'] }}" title="{{ alt_text }}">{{ row['title'] }}</a></h4>
                        </div>
                                <div class="blog-item-date">
                                    <ul>
                                        <li>
                                     <div class="post-date">{{ row['date']|date("M m, Y g:i:s A") }}</div>
                                        </li>
                                    </ul>
                                </div>
                        <div class="blog-group">
                            <div class="blog-item-intro">

                                    {% set content = row['longdescription']|split('.', 2) %}{{ content[0] }}


                                <div class="readmore"><a href="{{ row['url'] }}" class="btn btn-3">Read More <i class="fa fa-caret-right"></i></a></div>
                            </div>
                        </div>
                    </div>
                        {% endif %}

						{# offer details #}
						{% if var == 'home-blog' %}
                              {#  {% set featured = sd_getresults("data:<="~data.date|date_modify("-5 day")|date("m/d/Y")~"") %}#}

                                   <div class="hotnew-blog-item">
                                        <div class="hotnew-blog-content">
                                            <div class="hotnew-image col-md-6"><a href="{{ row['url'] }}"><div style="text-align: left;"><img src="{{ image_url }}" alt="{{ alt_text }}"></div></a></div>
                                            <div class="hotnew-content col-md-6">
                                                <h4><a href="{{ row['url'] }}" class="hotnew-title2 clearfix">{{ row['title'] }}</a></h4>
                                                <div class="blog-item-date">
                                                    <ul>
                                                        <li><span class="date"><i class="fa fa-calendar"></i>{{ row['date']|date("M m, Y g:i:s A") }}</span></li>
                                                        <li> <span><i class="fa fa-comments"></i>0 comments</span></li>
                                                        <li><i class="fa fa-user"></i>by <span>Jin Alkaid</span></li>
                                                    </ul>
                                                </div><!--End blog-item-date-->
                                                <div class="hotnew-desc">
                                                    {% set content = row['longdescription']|split('.', 2) %}{{ content[0] }}
                                                </div>
                                            </div>
                                        </div>
                                   </div>


						{% endif %}

                    {% set colnum = colnum + 1 %}
					
					{% set lastcol = lastcol + 1 %}
					{% if (lastcol == lastcolnext) %}
						{% set lastcol = 1 %}
					{% endif %}

					{% if (colnum == colnext) %}
						{% set colnum = 1 %}
					{% endif %}
				{% endif %}
			{% endfor %}
			
			{% if (colnum > 1) %}
				
			{% endif %}

			{# setup page nav, head, and foot #}
			{#
			<div class="toolbar-bottom">
				<div class="toolbar">
					<div class="pager">
						<div class="pages">
							{% set pages = sd_page_numbers('array') %}

							{% if (pages['total_pages'] > 1) %}
								<strong>Page:</strong>
								{{ pages['page_nums_plus'] }}
							{% endif %}
						</div>
					</div>
				</div>
			</div>
			#}
		{% elseif (sd_is_search and (not get_search_query())) %}
		{# html = '' #}
		{% else %}
		{# empty results #}
		<table rules="all" cellspacing="0" cellpadding="0" id="results-empty">
			<col width="800"/>
			<tr>
				<td>{{ sd_option('results_empty_default') }}</td>
			</tr>
		</table>
	    {% endif %}
	{% endif %}
{% else %}

	{% if (not output.items_html and not sd_is_get and group == group_settings['group']) %}
		{{ output.items_html }}
	{% else %}
		{# product grid #}
		{% if results %}
			{% spaceless %}
			{% set url = sd_seturl() %}

			{% set search_query = get_search_query() %}
			{% if search_query %}
				{% set search_query_string = 'q=' ~ search_query ~ '&' %}
			{% else %}
				{% set search_query_string = '' %}
			{% endif %}

			{% set sort_string = get_sort() %}
            {% if sort_string %}
                {% set sort_query_string = 'sort=' ~ sort_string ~ '&' %}
            {% else %}
                {% set sort_query_string = '' %}
            {% endif %}

            {% if get_reqs('page') %}
                {% set page_query_string = 'page=' ~ get_reqs('page') ~ '&' %}
            {% else %}
                {% set page_query_string = '' %}
            {% endif %}

            {% if search_query_string or sort_query_string  %}
                {% set full_query_string = search_query_string ~ sort_query_string ~ page_query_string %}
                {% set full_url = url ~ '?' ~ full_query_string %}
            {% else %}
                {% set full_query_string = '' %}
                {% set full_url = url %}
            {% endif %}

			{# setup output.sorting #}
			{% set sortlinks = [] %}
			{% set sortdefaults = sd_option('site_sort_defaults')|split('*') %}
			{% set sorticonasc = sd_option('site_sort_icon_asc') %}
			{% set sorticondesc = sd_option('site_sort_icon_desc') %}

			{# setup grid col count #}
			{% set colmaxset = sd_option('product_grid_columns') %}
			{% set colmax = colmaxset ? colmaxset : 5 %}

			{% set colmax = 4 %}
			{% set colwid = 800 / colmax %}

			{% for link in output.sorting %}
				{% if link in sortdefaults %}
					{% if (sort_string == link) %}
						{% set sort_selected = " selected" %}
					{% elseif (sort_string == (link ~ '_')) %}
						{% set sort_selected_d = " selected" %}
					{% else %}
						{% set sort_selected = '' %}
						{% set sort_selected_d = '' %}
					{% endif %}

					{% set sortlinks = sortlinks|merge(['<option value="' ~ link ~ '"' ~ sort_selected ~ '>' ~ output.sorting_labels[link] ~ ' ' ~ sorticonasc ~ '</option>']) %}
					{% set sortlinks = sortlinks|merge(['<option value="' ~ link ~ '_"' ~ sort_selected_d ~ '>' ~ output.sorting_labels[link] ~ ' ' ~ sorticondesc ~ '</option>']) %}
				{% endif %}
			{% endfor %}

			{% set sortoptions = '<select name="sort" onchange="sdAjaxForm(this.form)">' ~ (sortlinks|join('')) ~ '</select>' %}
			{% set grid_sort = '<form action="'~ url ~ '" method="get" id="sort-page-form" name="sort_page_form">' ~ sortoptions %}

			{% if (search_query) %}
				{% set grid_sort = grid_sort ~ '<input type="hidden" name="q" value="' ~search_query ~ '" />' %}
			{% endif %}

			{% if (group != group_settings['group']) %}
				{% set grid_sort = grid_sort ~ '<input type="hidden" name="view" value="' ~ group ~ '" />' %}
			{% endif %}
			{% set grid_sort = grid_sort ~ '</form>' %}
			{# offer sets #}
			{% set offerconditions = ['new', 'used', 'refurbished'] %}
			{% set offercurrency = sd_option('site_currency') %}
			{% endspaceless %}
			<div class="toolbar">
				<div class="sorter">
                    <p class="view-mode">
                        <label>View as:</label>

                        <strong title="Grid" class="grid">Grid</strong>
                        <a href="{{ full_url }}view=list" onclick="return sdAjaxCall('{{ full_query_string }}view=list')" title="List" class="list">List</a>
                    </p>

					<div class="sort-by hidden-xs hidden-sm">
						<label>Sort By</label>
						{{ grid_sort }}
					</div>
				</div>
				<div class="pager">
					{# setup page nav, head, and foot #}
					{% set pages = sd_page_numbers('array') %}
					{% if (pages['total_pages'] > 1) %}
						<div class="limiter hidden-xs hidden-sm">{{ pages['results_of'] }}</div>
						<div class="pages">
							<strong>Page:</strong>
							{{ pages['page_nums_plus'] }}
						</div>
					{% else %}
						<div class="limiter hidden-xs hidden-sm">{{ pages['total_items'] }}</div>
						<div class="pages"> </div>
					{% endif %}
				</div>
			</div>
			{# setup table #}
			{# get data and setup thumbs #}
			{% set colnum = 1 %}
			{% set colnext = colmax + 1 %}
			{% for key, row in results %}
				{% if (key == 'all' or key == 'time') %}
					{# continue #}
				{% else %}
					{% spaceless %}
					{% if row['guid'] %}
						{% set sku = row['guid'] %}
					{% else %}
						{% set sku = row['sku'] %}
					{% endif %}

					{% set media = sd_parsemedia(row['media']) %}

					{% if (is_image(media[0])) %}
						{% set image_url = sd_getmediathumb(media[0]) %}

						{% if media[1] %}
							{% set alt_text = media[1]|escape %}
						{% else %}
							{% set alt_text = row['title']|escape %}
						{% endif %}

						{% if (sd_option('image_thumb_titles') == 'on') %}
							{#
							{% set alt_text = alt_text ~ '" title="' ~ alt_text %}
							#}
						{% endif %}
					{% else %}
						{% set image_url = output.icons['no_thumb'] %}
						{% set alt_text = '' %}
					{% endif %}

					{% set discountpricecss = row['discountprice'] > 0 ? ' td-discount-price' : '' %}

					{% if (colnum == 1) %}
						{% if (rownum != 1) %}
							{% set rowclass = 'row-data' %}
							{% set rownum = 1 %}
						{% else %}
							{% set rowclass = 'row-data-x' %}
							{% set rownum = 0 %}
						{% endif %}
					<ul class="products-grid row {{ rowclass }} ">
					{% endif %}
					{% endspaceless %}

					<li class="item col-md-3 col-sm-6 col-sms-6 col-smb-12 " itemscope itemtype="http://schema.org/Product">
						<div class="item-inner">
							<div class="box-images">
								<a href="{{ sd_seturl(row['uri'], 'item') }}" title="{{ alt_text }}" class="product-image">
									<span class="">
										<img alt="{{ alt_text }}" class="row-data-img" src="{{ image_url }}"/>
									</span>
								</a>
							</div>
							<div class="product-shop">
								<div class="f-fix">
									<h2 class="product-name"><a href="{{ sd_seturl(row['uri'], 'item') }}">{{ row['title'] }}</a></h2>
									<div class="ratings">
										{{ sku }}
									</div>
									<div class="price-box">
										<span class="regular-price" >
                                            <span class="price" itemprop="offers" itemscope itemtype="http://schema.org/Offer">
	                                            {{ sd_price(false, true, true, row) }}
												<meta itemprop="priceCurrency" content="{{ offercurrency }}" />
												<meta itemprop="price" content="{{ sd_price(false, false, false, row) }}"/>
												<meta itemprop="availability" content="InStock" />
												{% if (row['total_stock']>0) %}
													<meta itemprop="inventoryLevel" content="{{ row['total_stock'] }}" />
												{% endif %}
												{% if (row['condition'] and offerconditions[row['condition']|lower] is defined ) %}
													<meta itemprop="itemCondition" itemtype="http://schema.org/OfferItemCondition" content="{{ offerconditions[row['condition']|lower] }}" />
												{% endif %}
												<meta itemprop="url" content="{{ sd_seturl(row['uri'], 'item') }}" />
                                            </span>
										</span>
									</div>
									<div class="actions">
										<a class="button btn-cart" href="{{ sd_seturl(row['uri'], 'item') }}"><span><span>View Details</span></span></a>
									</div>
								</div>
							</div>
						</div>
						{# offer details #}
						<meta itemprop="name" content="{{ row['title']|escape('html') }}" />
						{% if row['brand'] %}
							<meta itemprop="brand" content="{{ row['brand']|escape('html') }}" />
						{% endif %}
						{% if (is_image(media[0])) %}
							<meta itemprop="image" content="{{ media[0] }}" />
						{% endif %}
						{% if row['weight'] > 0 %}
							<meta itemprop="weight" content="{{ row['weight'] }}" />
						{% endif %}
						{% if row['color'] %}
							<meta itemprop="color" content="{{ row['color'] }}" />
						{% endif %}
						{% if row['upc']|length == 12 %}
							<meta itemprop="gtin12" content="{{ row['upc'] }}" />
						{% endif %}
						{% if (row['ean'] is defined and row['ean']) or row['upc']|length == 13 %}
							{% set rowean = row['ean'] is defined and row['ean'] ? row['ean'] : row['upc'] %}
							<meta itemprop="gtin13" content="{{ rowean }}" />
						{% endif %}
						{% if (row['gtin'] is defined and row['gtin']) %}
							<meta itemprop="gtin14" content="{{ row['gtin'] }}" />
						{% endif %}
						{% if (row['mpn'] is defined and row['mpn']) %}
							<meta itemprop="mpn" content="{{ row['mpn']|escape('html') }}" />
						{% endif %}
						{% if (row['manufacturer'] is defined and row['manufacturer']) %}
							<meta itemprop="manufacturer" content="{{ row['manufacturer']|escape('html') }}" />
						{% endif %}
						{% if (row['model'] is defined and row['model']) %}
							<meta itemprop="model" content="{{ row['model']|escape('html') }}" />
						{% endif %}
						<meta itemprop="sku" content="{{ row['guid']|escape('html') }}" />
					</li>
					{% if (colnum == colmax) %}
					</ul>
					{% endif %}

					{% set colnum= colnum + 1 %}

					{% if (colnum == colnext) %}
						{% set colnum = 1 %}
					{% endif %}
				{% endif %}
			{% endfor %}

			{% if (colnum > 1) %}
				</ul>
			{% endif %}

			{# setup page nav, head, and foot #}
			<div class="toolbar-bottom">
				<div class="toolbar">
					<div class="sorter">
                        <p class="view-mode">
                            <label>View as:</label>

                            <strong title="Grid" class="grid">Grid</strong>
                            <a href="{{ full_url }}view=list" onclick="return sdAjaxCall('{{ full_query_string }}view=list')" title="List" class="list">List</a>
                        </p>

						<div class="sort-by hidden-xs hidden-sm">
							<label>Sort By</label>
							{{ grid_sort }}
						</div>
					</div>
					<div class="pager">
						{# setup page nav, head, and foot #}
						{% set pages = sd_page_numbers('array') %}
						{% if (pages['total_pages'] > 1) %}
							<div class="limiter hidden-xs hidden-sm">{{ pages['results_of'] }}</div>
							<div class="pages">
								<strong>Page:</strong>
								{{ pages['page_nums_plus'] }}
							</div>
						{% else %}
							<div class="limiter hidden-xs hidden-sm">{{ pages['total_items'] }}</div>
							<div class="pages"> </div>
						{% endif %}
					</div>
				</div>
			</div>
		{% elseif (sd_is_search and (not get_search_query())) %}
		{# html = '' #}
		{% else %}
		{# empty results #}
		<table rules="all" cellspacing="0" cellpadding="0" id="results-empty">
			<col width="800"/>
			<tr>
				<td>{{ sd_option('results_empty_default') }}</td>
			</tr>
		</table>
	    {% endif %}
	{% endif %}

{% endif %}
